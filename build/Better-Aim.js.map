{"version":3,"file":"Better-Aim.js","sources":["../src/main.ts"],"sourcesContent":["import * as pegparser from './parser.js';\r\nimport { Parser } from \"pegjs\";\r\nconst parser : Parser = pegparser.default;\r\n\r\nlet test = parser.parse(\"repeat 5 times\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"\\n\" +\r\n    \"in parallel\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\" +\r\n    \"  spawn bullseye with delay 200 at(50,50)\\n\");\r\nconsole.log(test);\r\n\r\n\r\nlet UI = {gameDiv: document.getElementById(\"game-div\")};\r\n\r\nlet gameOptions = {\r\n    gameSize: {\r\n        height: 400,\r\n        width: 600\r\n    }\r\n\r\n};\r\n\r\nfunction randomNumber(min, max) {\r\n    return (Math.random() * (max - min)) + min;\r\n}\r\n\r\nclass Target {\r\n\r\n    options: any = {\r\n        position: \"fixed\",\r\n        x: 0,\r\n        y: 0\r\n    };\r\n    size: number = 50;\r\n    delay: number = 0;\r\n    lifeTime: number = 10.0;\r\n    locks: number = 0;\r\n    div;\r\n    isClicked: boolean = false;\r\n    color: string = \"#1759e8\";\r\n    isDead = false;\r\n    startTime = 0;\r\n\r\n    constructor(props) {\r\n        this.options = props.options;\r\n        this.size = props.size;\r\n        this.delay = props.delay;\r\n        this.lifeTime = props.lifeTime;\r\n        this.locks = props.locks;\r\n    }\r\n\r\n    public create() {\r\n        this.startTime = 0; //datetime now\r\n        this.div = document.createElement(\"div\");\r\n        this.div.classList.add(\"target\");\r\n        this.div.style.height = this.size + \"px\";\r\n        this.div.style.width = this.size + \"px\";\r\n        this.div.addEventListener('mousedown', () => this.clicked());\r\n        if (this.options.position == \"fixed\") {\r\n            this.div.style.position = \"absolute\";\r\n            this.div.style.top = this.options.y + \"px\";\r\n            this.div.style.left = this.options.x + \"px\";\r\n        }\r\n        if (this.options.position == \"random\") {\r\n            this.div.style.position = \"absolute\";\r\n            this.div.style.top = randomNumber(parseInt(this.options.y), parseInt(this.options.y2)) + \"px\";\r\n            this.div.style.left = randomNumber(parseInt(this.options.x), parseInt(this.options.x2)) + \"px\";\r\n        }\r\n\r\n        if (this.locks > 0)\r\n            this.div.style.backgroundColor = \"gray\";\r\n\r\n        this.div.style.zIndex = 10000 - this.locks;\r\n\r\n        let div = this.div;\r\n        setTimeout(function () {\r\n            UI.gameDiv.append(div);\r\n        }, this.delay * 1000);\r\n\r\n        setTimeout((() => {\r\n            this.kill();\r\n        }), (this.delay + this.lifeTime) * 1000)\r\n    }\r\n\r\n    public kill(div = this.div) {\r\n        this.isDead = true;\r\n        div.style.animation = 'explode 70ms forwards';\r\n        setTimeout(function () {\r\n            UI.gameDiv.removeChild(div);\r\n        }, 70);\r\n    }\r\n\r\n    public updateLock() {\r\n        if (this.locks > 0) {\r\n            this.locks--;\r\n            if (this.locks == 0)\r\n                this.div.style.backgroundColor = this.color;\r\n        }\r\n    };\r\n\r\n    public clicked() {\r\n        if (this.isClicked || this.locks > 0)\r\n            return;\r\n        updateTargetLocks();\r\n        this.kill();\r\n        this.isClicked = true;\r\n    }\r\n\r\n}\r\n\r\nfunction initializeGame() {\r\n    UI.gameDiv.style.height = String(gameOptions.gameSize.height + \"px\");\r\n    UI.gameDiv.style.width = String(gameOptions.gameSize.width + \"px\");\r\n}\r\n\r\ninitializeGame();\r\n\r\nlet targetList = [\r\n    new Target({\r\n        options: {\r\n            position: \"fixed\",\r\n            x: 50,\r\n            y: 50\r\n        },\r\n        size: 50,\r\n        delay: 0,\r\n        lifeTIme: 3,\r\n        locks: 0,\r\n        lifeTime: 10\r\n    }),\r\n    new Target({\r\n        options: {position: \"fixed\", x: 0, x2: 550, y: 0, y2: 350},\r\n        size: 50,\r\n        delay: 0,\r\n        locks: 1,\r\n        lifeTime: 10\r\n    }),\r\n    new Target({\r\n        options: {position: \"random\", x: 0, x2: 550, y: 0, y2: 350},\r\n        size: 50,\r\n        delay: 0,\r\n        locks: 2,\r\n        lifeTime: 10\r\n    }),\r\n    new Target({\r\n        options: {position: \"random\", x: 0, x2: 550, y: 0, y2: 350},\r\n        size: 50,\r\n        delay: 0,\r\n        locks: 3,\r\n        lifeTime: 10\r\n    }),\r\n    new Target({\r\n        options: {position: \"random\", x: 0, x2: 550, y: 0, y2: 350},\r\n        size: 50,\r\n        delay: 0,\r\n        locks: 4,\r\n        lifeTime: 10\r\n    }),\r\n    new Target({\r\n        options: {position: \"random\", x: 0, x2: 550, y: 0, y2: 350},\r\n        size: 50,\r\n        delay: 0,\r\n        locks: 5,\r\n        lifeTime: 10\r\n    })\r\n];\r\n\r\nclass Game {\r\n    targetList: any;\r\n\r\n    constructor(inputTargetList) {\r\n        targetList = inputTargetList;\r\n    }\r\n\r\n    aliveTargetExists(targetList) {\r\n        for (let i = 0; i < targetList.length; i++) {\r\n            if (!targetList[i].isDead)\r\n                return true\r\n        }\r\n        return false\r\n    }\r\n\r\n    updateTargetLocks(targetList) {\r\n        for (let i = 0; i < targetList.length; i++) {\r\n            targetList[i].updateLock();\r\n        }\r\n        targetList\r\n    }\r\n\r\n    startGame(targetList) {\r\n        for (let i = 0; i < targetList.length; i++) {\r\n            targetList[i].create();\r\n        }\r\n    }\r\n}\r\n\r\nfunction aliveTargetExists(targetList) {\r\n    for (let i = 0; i < targetList.length; i++) {\r\n        if (!targetList[i].isDead)\r\n            return true\r\n    }\r\n    return false\r\n}\r\n\r\nfunction updateTargetLocks() {\r\n    for (let i = 0; i < targetList.length; i++) {\r\n        targetList[i].updateLock();\r\n    }\r\n}\r\n\r\nfunction startGame() {\r\n    for (let i = 0; i < targetList.length; i++) {\r\n        targetList[i].create();\r\n    }\r\n}\r\n\r\nstartGame();\r\n\r\nfunction sequenceParser(nodeArray) {\r\n    let targetArray = [];\r\n    for (let i = 0; i < nodeArray.amount; i++)\r\n        targetArray.concat(nodeParser(nodeArray[i]));\r\n    return targetArray;\r\n}\r\n\r\nfunction nodeParser(node) {\r\n    switch (node.type) {\r\n        case \"target\":\r\n            return [new Target(node.props)];\r\n        case \"repeat\":\r\n            console.log(\"repeat\");\r\n            let array = [];\r\n            for (let i = 0; i < node.amount; i++)\r\n                array.push(new Target(node.children[i]));\r\n            return array;\r\n        default:\r\n            return [{}];\r\n    }\r\n}\r\n\r\n"],"names":["parser","pegparser.default"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}